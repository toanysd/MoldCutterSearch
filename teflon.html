<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>„ÉÜ„Éï„É≠„É≥Âä†Â∑•ÁÆ°ÁêÜ - Teflon Coating Management V4.31</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="teflon-styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

<!-- Header -->
<header class="header">
    <div class="header-content">
        <button class="back-btn" onclick="window.location.href='index.html'" title="Êàª„Çã">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M12 16L6 10L12 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
        </button>
        <div class="header-title">
            <h1>üõ°Ô∏è „ÉÜ„Éï„É≠„É≥Âä†Â∑•ÁÆ°ÁêÜ<br><small>Teflon Coating Management</small></h1>
        </div>
        <div class="header-actions">
            <button class="btn-header-icon" onclick="refreshTeflonData()" title="Êõ¥Êñ∞ / Refresh">
                <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
                    <path d="M17 10C17 13.866 13.866 17 10 17C6.134 17 3 13.866 3 10C3 6.134 6.134 3 10 3C12.1 3 13.94 3.87 15.24 5.24M15 3V7H11" stroke="currentColor" stroke-width="2"/>
                </svg>
            </button>
            <button class="btn-header-icon" onclick="exportTeflonCSV()" title="„Ç®„ÇØ„Çπ„Éù„Éº„Éà / Export">
                <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
                    <path d="M3 15v2a2 2 0 002 2h10a2 2 0 002-2v-2M10 3v12m0 0l-4-4m4 4l4-4" stroke="currentColor" stroke-width="2"/>
                </svg>
            </button>
        </div>
    </div>
</header>

<!-- Status Filter Tabs -->
<section class="status-filter-section">
    <div class="container">
        <div class="status-tabs">
            <button class="status-tab active" data-status="all" onclick="filterByTeflonStatus('all')">
                <span class="tab-icon">üìã</span>
                <div class="tab-content">
                    <span class="tab-label">„Åô„Åπ„Å¶<br>T·∫•t c·∫£</span>
                    <span class="tab-count" id="countAll">0</span>
                </div>
            </button>
            
            <button class="status-tab" data-status="„ÉÜ„Éï„É≠„É≥Âä†Â∑•ÊâøË™çÂæÖ„Å°" onclick="filterByTeflonStatus('„ÉÜ„Éï„É≠„É≥Âä†Â∑•ÊâøË™çÂæÖ„Å°')">
                <span class="tab-icon">‚è≥</span>
                <div class="tab-content">
                    <span class="tab-label">ÊâøË™çÂæÖ„Å°<br>Ch·ªù x√°c nh·∫≠n</span>
                    <span class="tab-count" id="countPending">0</span>
                </div>
            </button>
            
            <button class="status-tab" data-status="„ÉÜ„Éï„É≠„É≥Âä†Â∑•‰∏≠" onclick="filterByTeflonStatus('„ÉÜ„Éï„É≠„É≥Âä†Â∑•‰∏≠')">
                <span class="tab-icon">‚öôÔ∏è</span>
                <div class="tab-content">
                    <span class="tab-label">Âä†Â∑•‰∏≠<br>ƒêang m·∫°</span>
                    <span class="tab-count" id="countProcessing">0</span>
                </div>
            </button>
            
            <button class="status-tab" data-status="„ÉÜ„Éï„É≠„É≥Âä†Â∑•Ê∏à" onclick="filterByTeflonStatus('„ÉÜ„Éï„É≠„É≥Âä†Â∑•Ê∏à')">
                <span class="tab-icon">‚úÖ</span>
                <div class="tab-content">
                    <span class="tab-label">Âä†Â∑•Ê∏à<br>ƒê√£ m·∫°</span>
                    <span class="tab-count" id="countCompleted">0</span>
                </div>
            </button>
        </div>
    </div>
</section>

<!-- Search and Controls -->
<section class="controls-section">
    <div class="container">
        <div class="controls-wrapper">
            <!-- Search Box -->
            <div class="search-box">
                <svg class="search-icon" width="18" height="18" viewBox="0 0 20 20" fill="none">
                    <circle cx="9" cy="9" r="6" stroke="currentColor" stroke-width="2"/>
                    <path d="M14 14l4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <input type="text" id="teflonSearchInput" class="search-input" 
                       placeholder="ÈáëÂûãID„ÄÅÂêçÁß∞„ÄÅÂõ≥Èù¢Áï™Âè∑„ÅßÊ§úÁ¥¢... / T√¨m ki·∫øm theo ID, t√™n, s·ªë b·∫£n v·∫Ω..." 
                       oninput="handleTeflonSearch()">
            </div>
            
            <!-- Sort Control -->
            <div class="sort-control">
                <select id="teflonSortSelect" class="sort-select" onchange="handleTeflonSort()">
                    <option value="recent">ÊúÄÊñ∞È†Ü / M·ªõi nh·∫•t</option>
                    <option value="oldest">Âè§„ÅÑÈ†Ü / C≈© nh·∫•t</option>
                    <option value="moldid">ÈáëÂûãIDÈ†Ü / Theo ID</option>
                    <option value="status">Áä∂ÊÖãÈ†Ü / Theo tr·∫°ng th√°i</option>
                </select>
            </div>
        </div>
    </div>
</section>

<!-- Data Table Section -->
<section class="table-section">
    <div class="container">
        <!-- Table Header -->
        <div class="table-header">
            <h2 class="section-title">
                ÈáëÂûã„É™„Çπ„Éà<br>
                <small>Danh s√°ch khu√¥n m·∫° Teflon</small>
            </h2>
            <div class="result-info">
                <span>Ë°®Á§∫ / Hi·ªÉn th·ªã: <strong id="displayCount">0</strong> / <strong id="totalCount">0</strong> ‰ª∂</span>
            </div>
        </div>

        <!-- Table Wrapper -->
        <div class="table-container">
            <table class="data-table" id="teflonTable">
                <thead>
                    <tr>
                        <th class="sortable" onclick="sortTeflonTable('MoldID')">
                            ÈáëÂûãID<br><small>Mold ID</small>
                            <span class="sort-indicator" id="sortIconMoldID"></span>
                        </th>
                        <th class="sortable" onclick="sortTeflonTable('MoldName')">
                            ÂêçÁß∞<br><small>T√™n khu√¥n</small>
                            <span class="sort-indicator" id="sortIconMoldName"></span>
                        </th>
                        <th class="sortable" onclick="sortTeflonTable('DrawingNumber')">
                            Âõ≥Èù¢Áï™Âè∑<br><small>S·ªë b·∫£n v·∫Ω</small>
                            <span class="sort-indicator" id="sortIconDrawingNumber"></span>
                        </th>
                        <th class="sortable" onclick="sortTeflonTable('TeflonStatus')">
                            Áä∂ÊÖã<br><small>Tr·∫°ng th√°i</small>
                            <span class="sort-indicator" id="sortIconTeflonStatus"></span>
                        </th>
                        <th class="sortable" onclick="sortTeflonTable('SentDate')">
                            ÈÄÅ‰ªòÊó•<br><small>Ng√†y g·ª≠i</small>
                            <span class="sort-indicator" id="sortIconSentDate"></span>
                        </th>
                        <th class="sortable" onclick="sortTeflonTable('ExpectedDate')">
                            ËøîÂç¥‰∫àÂÆö<br><small>D·ª± ki·∫øn nh·∫≠n</small>
                            <span class="sort-indicator" id="sortIconExpectedDate"></span>
                        </th>
                        <th class="sortable" onclick="sortTeflonTable('ReceivedDate')">
                            ËøîÂç¥Êó•<br><small>ƒê√£ nh·∫≠n</small>
                            <span class="sort-indicator" id="sortIconReceivedDate"></span>
                        </th>
                        <th>Êìç‰Ωú<br><small>Thao t√°c</small></th>
                    </tr>
                </thead>
                <tbody id="teflonTableBody">
                    <!-- Dynamic content -->
                </tbody>
            </table>
        </div>

        <!-- Empty State -->
        <div id="teflonEmptyState" class="empty-state" style="display: none;">
            <div class="empty-icon">üì≠</div>
            <h3>„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì<br>Kh√¥ng c√≥ d·ªØ li·ªáu</h3>
            <p>„Éï„Ç£„É´„Çø„ÇíÂ§âÊõ¥„Åó„Å¶„Åè„Å†„Åï„ÅÑ<br>Vui l√≤ng thay ƒë·ªïi b·ªô l·ªçc</p>
        </div>

        <!-- Pagination -->
        <div class="pagination-bar">
            <div class="pagination-info">
                <span>„Éö„Éº„Ç∏ <strong id="teflonCurrentPage">1</strong> / <strong id="teflonTotalPages">1</strong></span>
            </div>
            <div class="pagination-controls">
                <button class="btn-page" id="teflonPrevBtn" onclick="teflonPrevPage()" disabled>
                    <svg width="14" height="14" viewBox="0 0 16 16">
                        <path d="M10 12L6 8l4-4" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                    Ââç„Å∏
                </button>
                <button class="btn-page" id="teflonNextBtn" onclick="teflonNextPage()" disabled>
                    Ê¨°„Å∏
                    <svg width="14" height="14" viewBox="0 0 16 16">
                        <path d="M6 12l4-4-4-4" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                </button>
            </div>
            <select class="page-size-select" id="teflonPageSize" onchange="changeTeflonPageSize()">
                <option value="20">20‰ª∂/„Éö„Éº„Ç∏</option>
                <option value="50" selected>50‰ª∂/„Éö„Éº„Ç∏</option>
                <option value="100">100‰ª∂/„Éö„Éº„Ç∏</option>
            </select>
        </div>
    </div>
</section>

<!-- Update Teflon Modal -->
<div id="updateTeflonModal" class="modal-overlay">
    <div class="modal-dialog">
        <div class="modal-header">
            <h3>„ÉÜ„Éï„É≠„É≥Âä†Â∑•ÊÉÖÂ†±Êõ¥Êñ∞<br><small>C·∫≠p nh·∫≠t th√¥ng tin m·∫° Teflon</small></h3>
            <button class="modal-close" onclick="closeUpdateTeflonModal()">√ó</button>
        </div>
        
        <form id="updateTeflonForm" class="modal-body" onsubmit="submitTeflonUpdate(event)">
            <!-- Mold Info Display -->
            <div class="info-display-card">
                <div class="info-row">
                    <span class="info-label">ÈáëÂûãID / Mold ID:</span>
                    <span class="info-value" id="updateMoldId">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">ÂêçÁß∞ / Name:</span>
                    <span class="info-value" id="updateMoldName">-</span>
                </div>
            </div>

            <!-- Form Fields -->
            <div class="form-grid">
                <div class="form-group full-width">
                    <label class="form-label">Áä∂ÊÖã / Tr·∫°ng th√°i <span class="required">*</span></label>
                    <select id="teflonStatus" class="form-control" required onchange="handleTeflonStatusChange()">
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn</option>
                        <option value="„ÉÜ„Éï„É≠„É≥Âä†Â∑•ÊâøË™çÂæÖ„Å°">‚è≥ ÊâøË™çÂæÖ„Å° / Ch·ªù x√°c nh·∫≠n</option>
                        <option value="„ÉÜ„Éï„É≠„É≥Âä†Â∑•‰∏≠">‚öôÔ∏è Âä†Â∑•‰∏≠ / ƒêang m·∫°</option>
                        <option value="„ÉÜ„Éï„É≠„É≥Âä†Â∑•Ê∏à">‚úÖ Âä†Â∑•Ê∏à / ƒê√£ m·∫° xong</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">ÈÄÅ‰ªòÊó• / Ng√†y g·ª≠i</label>
                    <input type="date" id="sentDate" class="form-control">
                </div>

                <div class="form-group">
                    <label class="form-label">ËøîÂç¥‰∫àÂÆöÊó• / Ng√†y d·ª± ki·∫øn</label>
                    <input type="date" id="expectedDate" class="form-control">
                </div>

                <div class="form-group">
                    <label class="form-label">ËøîÂç¥Êó• / Ng√†y nh·∫≠n</label>
                    <input type="date" id="receivedDate" class="form-control">
                </div>

                <div class="form-group">
                    <label class="form-label">Ê•≠ËÄÖ / Nh√† cung c·∫•p</label>
                    <select id="supplierId" class="form-control">
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn</option>
                        <!-- Populated from companies data -->
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">ÁêÜÁî± / L√Ω do</label>
                    <select id="reason" class="form-control">
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn</option>
                        <option value="Êñ∞Ë¶èË£ΩÈÄ†">Êñ∞Ë¶èË£ΩÈÄ† / M·ªõi s·∫£n xu·∫•t</option>
                        <option value="ÂÆöÊúü„É°„É≥„ÉÜ„Éä„É≥„Çπ">ÂÆöÊúü„É°„É≥„ÉÜ„Éä„É≥„Çπ / B·∫£o tr√¨</option>
                        <option value="Âä£ÂåñÂØæÂøú">Âä£ÂåñÂØæÂøú / Xu·ªëng c·∫•p</option>
                        <option value="Ë£ΩÂìÅÂìÅË≥™ÊîπÂñÑ">Ë£ΩÂìÅÂìÅË≥™ÊîπÂñÑ / C·∫£i thi·ªán</option>
                        <option value="È°ßÂÆ¢Ë¶ÅÊ±Ç">È°ßÂÆ¢Ë¶ÅÊ±Ç / Y√™u c·∫ßu KH</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Ë≤ªÁî® / Chi ph√≠ (¬•)</label>
                    <input type="number" id="teflonCost" class="form-control" min="0" step="0.01">
                </div>

                <div class="form-group">
                    <label class="form-label">ÂìÅË≥™ / Ch·∫•t l∆∞·ª£ng</label>
                    <select id="quality" class="form-control">
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn</option>
                        <option value="ËâØÂ•Ω">‚úÖ ËâØÂ•Ω / T·ªët</option>
                        <option value="ÂèØ">‚ö†Ô∏è ÂèØ / Ch·∫•p nh·∫≠n</option>
                        <option value="‰∏çËâØ">‚ùå ‰∏çËâØ / Kh√¥ng ƒë·∫°t</option>
                    </select>
                </div>

                <div class="form-group full-width">
                    <label class="form-label">ÂÇôËÄÉ / Ghi ch√∫</label>
                    <textarea id="teflonNotes" class="form-control" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">ÊãÖÂΩìËÄÖ / Ng∆∞·ªùi th·ª±c hi·ªán</label>
                    <select id="createdBy" class="form-control">
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn</option>
                        <!-- Populated from employees data -->
                    </select>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeUpdateTeflonModal()">
                    „Ç≠„É£„É≥„Çª„É´ / H·ªßy
                </button>
                <button type="submit" class="btn btn-primary">
                    ‰øùÂ≠ò / L∆∞u
                </button>
            </div>
        </form>
    </div>
</div>

<!-- History Modal -->
<div id="teflonLogModal" class="modal-overlay">
    <div class="modal-dialog modal-wide">
        <div class="modal-header">
            <h3>„ÉÜ„Éï„É≠„É≥Âä†Â∑•Â±•Ê≠¥<br><small>L·ªãch s·ª≠ m·∫° Teflon</small></h3>
            <button class="modal-close" onclick="closeTeflonLogModal()">√ó</button>
        </div>
        
        <div class="modal-body">
            <!-- Mold Info -->
            <div class="info-display-card">
                <div class="info-row">
                    <span class="info-label">ÈáëÂûãID:</span>
                    <span class="info-value" id="historyMoldId">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">ÂêçÁß∞:</span>
                    <span class="info-value" id="historyMoldName">-</span>
                </div>
            </div>

            <!-- Timeline -->
            <div class="history-timeline" id="teflonLogTimeline">
                <!-- Dynamic timeline items -->
            </div>

            <!-- Empty State -->
            <div id="historyEmptyState" class="empty-state-small" style="display: none;">
                <p>Â±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì<br>Ch∆∞a c√≥ l·ªãch s·ª≠</p>
            </div>
        </div>
    </div>
</div>

<!-- Loading Overlay -->
<div id="teflonLoadingOverlay" class="loading-overlay" style="display: none;">
    <div class="spinner"></div>
    <p>Âá¶ÁêÜ‰∏≠...<br>ƒêang x·ª≠ l√Ω...</p>
</div>

<!-- Toast Notification -->
<div id="teflonToast" class="toast"></div>

<!-- Scripts -->
<script src="teflon.js"></script>
</body>
</html>
