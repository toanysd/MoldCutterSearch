<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈáëÂûãË©≥Á¥∞ - MoldCutterSearch V5.5</title>
    <!-- V5.5 - Compact Header + Tab Design - Updated 2025.09.21 -->
    <!-- 2-column layout, fixed action buttons, back navigation -->
    <link rel="stylesheet" href="detail-mold-styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ===== COMPACT HEADER V5.5 ===== -->
    <div class="header-container">
        <div class="header-top">
            <div class="header-left">
                <!-- Navigation buttons -->
                <div class="header-nav-buttons">
                    <a href="index.html" class="nav-btn">
                        ‚Üê Ê§úÁ¥¢„Éö„Éº„Ç∏
                    </a>
                    <button onclick="goBack()" class="nav-btn">
                        ‚Üê Ê§úÁ¥¢ÁµêÊûú
                    </button>
                </div>

                <!-- Title -->
                <h1 class="header-title" id="moldTitle">Loading...</h1>
                <div class="header-subtitle" id="moldSubtitle">ÈáëÂûãË©≥Á¥∞ÊÉÖÂ†±</div>
            </div>

            <!-- Fixed action buttons -->
            <div class="header-right">
                <button id="showLocationBtn" class="header-action-btn">
                    üìç ‰ΩçÁΩÆÊõ¥Êñ∞
                </button>
                <button id="showShipmentBtn" class="header-action-btn">
                    üöö Âá∫Ëç∑ÁôªÈå≤
                </button>
                <button id="showCommentBtn" class="header-action-btn">
                    üí¨ „Ç≥„É°„É≥„Éà
                </button>
            </div>
        </div>
    </div>

    <!-- ===== MAIN CONTAINER ===== -->
    <div class="main-container">
        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <ul class="tab-nav-list">
                <li class="tab-nav-item">
                    <a href="#summary" class="tab-nav-link active" data-tab="summary">
                        üìã ÊÉÖÂ†±Á∑èÂêà
                    </a>
                </li>
                <li class="tab-nav-item">
                    <a href="#product" class="tab-nav-link" data-tab="product">
                        üì¶ Ë£ΩÂìÅ
                    </a>
                </li>
                <li class="tab-nav-item">
                    <a href="#technical" class="tab-nav-link" data-tab="technical">
                        ‚öôÔ∏è ÊäÄË°ì
                    </a>
                </li>
                <li class="tab-nav-item">
                    <a href="#processing" class="tab-nav-link" data-tab="processing">
                        üîÑ Âá¶ÁêÜ„ÉªÂ±•Ê≠¥
                    </a>
                </li>
            </ul>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- ===== TAB 1: SUMMARY (ÊÉÖÂ†±Á∑èÂêà) ===== -->
            <div id="summary" class="tab-pane active">
                <div class="info-grid two-cols">
                    <!-- Basic Summary Info -->
                    <div class="info-section">
                        <div class="section-header">
                            <div class="section-icon">üè∑Ô∏è</div>
                            <h3 class="section-title">Âü∫Êú¨ÊÉÖÂ†±</h3>
                        </div>
                        <div id="summaryBasicInfo" class="info-rows">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Tray Information -->
                    <div class="info-section">
                        <div class="section-header">
                            <div class="section-icon">üìã</div>
                            <h3 class="section-title">„Éà„É¨„Ç§ÊÉÖÂ†±</h3>
                        </div>
                        <div id="summaryTrayInfo" class="info-rows">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Related Cutters Section -->
                <div class="info-section cutters-section">
                    <div class="section-header">
                        <div class="section-icon">üîß</div>
                        <h3 class="section-title">Èñ¢ÈÄ£„Ç´„ÉÉ„Çø„Éº</h3>
                    </div>
                    <div id="summaryRelatedCutters">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- ===== TAB 2: PRODUCT (Ë£ΩÂìÅ) ===== -->
            <div id="product" class="tab-pane">
                <div class="info-grid two-cols">
                    <!-- Product Details -->
                    <div class="info-section">
                        <div class="section-header">
                            <div class="section-icon">üì¶</div>
                            <h3 class="section-title">Ë£ΩÂìÅË©≥Á¥∞</h3>
                        </div>
                        <div id="productDetails" class="info-rows">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Business Information -->
                    <div class="info-section">
                        <div class="section-header">
                            <div class="section-icon">üí∞</div>
                            <h3 class="section-title">ÂïÜÊ•≠ÊÉÖÂ†±</h3>
                        </div>
                        <div id="productBusinessInfo" class="info-rows">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== TAB 3: TECHNICAL (ÊäÄË°ì) ===== -->
            <div id="technical" class="tab-pane">
                <div class="info-grid two-cols">
                    <!-- Design Specifications -->
                    <div class="info-section">
                        <div class="section-header">
                            <div class="section-icon">‚öôÔ∏è</div>
                            <h3 class="section-title">Ë®≠Ë®à‰ªïÊßò</h3>
                        </div>
                        <div id="technicalDesignSpecs" class="info-rows">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Manufacturing Details -->
                    <div class="info-section">
                        <div class="section-header">
                            <div class="section-icon">üî®</div>
                            <h3 class="section-title">Ë£ΩÈÄ†Ë©≥Á¥∞</h3>
                        </div>
                        <div id="technicalManufacturingDetails" class="info-rows">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== TAB 4: PROCESSING & HISTORY (Âá¶ÁêÜ„ÉªÂ±•Ê≠¥) ===== -->
            <div id="processing" class="tab-pane">
                <!-- Processing Status -->
                <div class="info-section">
                    <div class="section-header">
                        <div class="section-icon">üîÑ</div>
                        <h3 class="section-title">Âá¶ÁêÜÁä∂Ê≥Å</h3>
                    </div>
                    <div id="processingStatus">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <div class="info-grid two-cols">
                    <!-- Location History -->
                    <div class="info-section">
                        <div class="section-header">
                            <div class="section-icon">üìç</div>
                            <h3 class="section-title">‰ΩçÁΩÆÂ±•Ê≠¥</h3>
                        </div>
                        <div id="processingLocationHistory" class="history-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Shipment History -->
                    <div class="info-section">
                        <div class="section-header">
                            <div class="section-icon">üöö</div>
                            <h3 class="section-title">Âá∫Ëç∑Â±•Ê≠¥</h3>
                        </div>
                        <div id="processingShipmentHistory" class="history-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- User Comments -->
                <div class="info-section">
                    <div class="section-header">
                        <div class="section-icon">üí¨</div>
                        <h3 class="section-title">„Ç≥„É°„É≥„Éà</h3>
                    </div>
                    <div id="processingUserComments">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== MODALS ===== -->
    <!-- Location Modal -->
    <div id="locationModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('locationModal')">&times;</span>
            <h3>‰ΩçÁΩÆÊõ¥Êñ∞ / C·∫≠p nh·∫≠t v·ªã tr√≠</h3>
            <form id="locationForm">
                <div class="form-group">
                    <label>„É©„ÉÉ„ÇØ / Gi√°:</label>
                    <select id="rackSelect" required>
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn gi√°</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>„É¨„Ç§„É§„Éº / T·∫ßng:</label>
                    <select id="rackLayerSelect" required>
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn t·∫ßng</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ÊãÖÂΩìËÄÖ / Ng∆∞·ªùi th·ª±c hi·ªán:</label>
                    <select id="employeeSelect" required>
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn ng∆∞·ªùi</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ÂÇôËÄÉ / Ghi ch√∫:</label>
                    <textarea id="locationNotes" rows="2" placeholder="ÂÇôËÄÉ„ÇíÂÖ•Âäõ..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit">Êõ¥Êñ∞ / C·∫≠p nh·∫≠t</button>
                    <button type="button" onclick="closeModal('locationModal')">„Ç≠„É£„É≥„Çª„É´ / H·ªßy</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Shipment Modal -->
    <div id="shipmentModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('shipmentModal')">&times;</span>
            <h3>Âá∫Ëç∑ÁôªÈå≤ / ƒêƒÉng k√Ω v·∫≠n chuy·ªÉn</h3>
            <form id="shipmentForm">
                <div class="form-group">
                    <label>Âá∫Ëç∑ÂÖà / ƒê√≠ch ƒë·∫øn:</label>
                    <select id="toCompanySelect" required>
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn c√¥ng ty</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Âá∫Ëç∑Êó• / Ng√†y v·∫≠n chuy·ªÉn:</label>
                    <input type="date" id="shipmentDate" required>
                </div>
                <div class="form-group">
                    <label>ÊãÖÂΩìËÄÖ / Ng∆∞·ªùi th·ª±c hi·ªán:</label>
                    <input type="text" id="handler" placeholder="ÊãÖÂΩìËÄÖÂêç„ÇíÂÖ•Âäõ...">
                </div>
                <div class="form-group">
                    <label>ÂÇôËÄÉ / Ghi ch√∫:</label>
                    <textarea id="shipmentNotes" rows="2" placeholder="ÂÇôËÄÉ„ÇíÂÖ•Âäõ..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit">ÁôªÈå≤ / ƒêƒÉng k√Ω</button>
                    <button type="button" onclick="closeModal('shipmentModal')">„Ç≠„É£„É≥„Çª„É´ / H·ªßy</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Comment Modal -->
    <div id="commentModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('commentModal')">&times;</span>
            <h3>„Ç≥„É°„É≥„ÉàËøΩÂä† / Th√™m b√¨nh lu·∫≠n</h3>
            <form id="commentForm">
                <div class="form-group">
                    <label>ÊãÖÂΩìËÄÖ / Ng∆∞·ªùi b√¨nh lu·∫≠n:</label>
                    <select id="commentEmployeeSelect" required>
                        <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ / Ch·ªçn ng∆∞·ªùi</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>„Ç≥„É°„É≥„Éà / B√¨nh lu·∫≠n:</label>
                    <textarea id="commentText" rows="3" required placeholder="„Ç≥„É°„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit">ËøΩÂä† / Th√™m</button>
                    <button type="button" onclick="closeModal('commentModal')">„Ç≠„É£„É≥„Çª„É´ / H·ªßy</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading indicator -->
    <div id="loadingIndicator" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p>„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø‰∏≠... / ƒêang t·∫£i d·ªØ li·ªáu...</p>
    </div>

    <!-- Error container -->
    <div id="errorContainer" style="display: none; position: fixed; top: 20px; left: 20px; right: 20px; background: #f8d7da; color: #721c24; padding: 12px; border-radius: 8px; z-index: 9998;"></div>

    <!-- JavaScript -->
    <script src="script.js"></script>
    <script src="detail-mold.js"></script>

    <script>
        // Tab Navigation V5.5
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize tab functionality
            const tabLinks = document.querySelectorAll('.tab-nav-link');
            const tabPanes = document.querySelectorAll('.tab-pane');

            tabLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();

                    // Remove active class from all tabs and panes
                    tabLinks.forEach(l => l.classList.remove('active'));
                    tabPanes.forEach(p => p.classList.remove('active'));

                    // Add active class to clicked tab
                    this.classList.add('active');

                    // Show corresponding pane
                    const targetTab = this.getAttribute('data-tab');
                    document.getElementById(targetTab).classList.add('active');
                });
            });

            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                const modals = ['locationModal', 'shipmentModal', 'commentModal'];
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    if (event.target === modal) {
                        closeModal(modalId);
                    }
                });
            });
        });

        // Navigation functions
        function goBack() {
            if (document.referrer && document.referrer.includes(window.location.hostname)) {
                window.history.back();
            } else {
                window.location.href = 'index.html';
            }
        }

        // Modal controls
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>