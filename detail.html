<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë©≥Á¥∞ÊÉÖÂ†± - Chi ti·∫øt</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="detail-layout">
        <!-- Left Sidebar - Main Info & Quick Actions -->
        <aside class="detail-sidebar">
            <!-- Header -->
            <div class="sidebar-header">
                <button onclick="goBack()" class="btn-back">‚Üê Êàª„Çã</button>
                <div class="item-title">
                    <div class="item-type-label" id="itemTypeLabel">ÈáëÂûã</div>
                    <div class="item-name" id="itemName">TDW-001D R3</div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions-section">
                <h3>„ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥ - Thao t√°c nhanh</h3>
                <div class="action-buttons">
                    <button onclick="showLocationUpdate()" class="action-btn location">
                        üìç ‰ΩçÁΩÆÂ§âÊõ¥
                    </button>
                    <button onclick="showShipmentUpdate()" class="action-btn shipment">
                        üöö Âá∫Ëç∑Ë®òÈå≤
                    </button>
                    <button onclick="showFeedback()" class="action-btn feedback">
                        üí¨ „Ç≥„É°„É≥„Éà
                    </button>
                </div>
            </div>

            <!-- Basic Information -->
            <div class="sidebar-section">
                <h3>Âü∫Êú¨ÊÉÖÂ†± - Th√¥ng tin c∆° b·∫£n</h3>
                <div class="info-grid-compact" id="basicInfo"></div>
            </div>

            <!-- Technical Information -->
            <div class="sidebar-section">
                <h3>ÊäÄË°ìÊÉÖÂ†± - Th√¥ng tin k·ªπ thu·∫≠t</h3>
                <div class="info-grid-compact" id="technicalInfo"></div>
            </div>

            <!-- Status Information -->
            <div class="sidebar-section">
                <h3>Áä∂ÊÖãÊÉÖÂ†± - Th√¥ng tin tr·∫°ng th√°i</h3>
                <div class="info-grid-compact" id="statusInfo"></div>
            </div>

            <!-- Location History -->
            <div class="sidebar-section">
                <h3>‰ΩçÁΩÆÂ±•Ê≠¥ - L·ªãch s·ª≠ v·ªã tr√≠</h3>
                <div class="history-compact" id="locationHistoryCompact"></div>
            </div>
        </aside>

        <!-- Main Content Area - Full width -->
        <main class="detail-main" id="detailContent" style="display: none;">
            <!-- Design Information -->
            <section class="content-section" id="designSection" style="display: none;">
                <h3>Ë®≠Ë®àÊÉÖÂ†± - Th√¥ng tin thi·∫øt k·∫ø</h3>
                <div class="design-info-grid" id="designInfo"></div>
            </section>

            <!-- Th√™m section m·ªõi sau Design Information -->
            <section class="content-section" id="productSection">
                <h3>Ë£ΩÂìÅÊÉÖÂ†± - Th√¥ng tin s·∫£n ph·∫©m</h3>
                <div class="product-info-grid" id="productInfo"></div>
            </section>

            <!-- Location Details -->
            <section class="content-section">
                <h3>‰ΩçÁΩÆË©≥Á¥∞ - Chi ti·∫øt v·ªã tr√≠</h3>
                <div class="location-details" id="locationDetails"></div>
                
                <h4>‰ΩçÁΩÆÂ§âÊõ¥Â±•Ê≠¥ - L·ªãch s·ª≠ thay ƒë·ªïi v·ªã tr√≠</h4>
                <div class="timeline" id="locationHistoryFull"></div>
            </section>

            <!-- Shipment History -->
            <section class="content-section">
                <h3>Âá∫Ëç∑Â±•Ê≠¥ - L·ªãch s·ª≠ v·∫≠n chuy·ªÉn</h3>
                <div class="timeline" id="shipmentHistoryFull"></div>
            </section>

            <!-- Related Items -->
            <section class="content-section" id="relatedSection" style="display: none;">
                <h3 id="relatedTitle">Èñ¢ÈÄ£„Ç¢„Ç§„ÉÜ„É† - M·ª•c li√™n quan</h3>
                <div class="related-grid" id="relatedItems"></div>
            </section>

            <!-- User Feedback -->
            <section class="content-section" id="feedbackSection" style="display: none;">
                <h3>„É¶„Éº„Ç∂„Éº„Ç≥„É°„É≥„Éà - Ghi ch√∫ ng∆∞·ªùi d√πng</h3>
                <div class="feedback-list" id="feedbackList"></div>
            </section>
        </main>

        <!-- Error Message -->
        <div id="errorMessage" class="error-overlay" style="display: none;">
            <div class="error-content">
                <div class="error-icon">‚ö†Ô∏è</div>
                <h3>„Ç®„É©„Éº - L·ªói</h3>
                <p id="errorText"></p>
                <button onclick="goBack()" class="btn-primary">Êàª„Çã - Quay l·∫°i</button>
            </div>
        </div>

        <!-- Location Update Modal - FIXED LAYOUT -->
        <div id="locationModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üìç ‰ΩçÁΩÆÂ§âÊõ¥ - Thay ƒë·ªïi v·ªã tr√≠</h3>
                    <button onclick="closeModal('locationModal')" class="modal-close">√ó</button>
                </div>
                <div class="modal-body">
                    <!-- Current Location Info -->
                    <div class="current-info">
                        <div class="current-info-title">ÁèæÂú®‰ΩçÁΩÆ - V·ªã tr√≠ hi·ªán t·∫°i</div>
                        <div class="current-info-value" id="currentLocationDisplay">-</div>
                    </div>
                    
                    <form id="locationForm" class="compact-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label>„É©„ÉÉ„ÇØ - Gi√° <span class="required">*</span></label>
                                <select id="rackSelect" onchange="updateLayerOptions()" required>
                                    <option value="">ÈÅ∏Êäû - Ch·ªçn</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>„É¨„Ç§„É§„Éº - T·∫ßng <span class="required">*</span></label>
                                <select id="layerSelect" required>
                                    <option value="">ÈÅ∏Êäû - Ch·ªçn</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Â§âÊõ¥ËÄÖ - Ng∆∞·ªùi thay ƒë·ªïi <span class="required">*</span></label>
                            <select id="employeeSelect" required>
                                <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ - Ch·ªçn nh√¢n vi√™n</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>ÂÇôËÄÉ - Ghi ch√∫</label>
                            <textarea id="locationNotes" placeholder="‰ΩçÁΩÆÂ§âÊõ¥„ÅÆÁêÜÁî±„Å™„Å© - L√Ω do thay ƒë·ªïi..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" onclick="closeModal('locationModal')" class="btn-secondary">
                        „Ç≠„É£„É≥„Çª„É´ - H·ªßy
                    </button>
                    <button type="submit" form="locationForm" class="btn-primary">
                        üíæ ‰øùÂ≠ò - L∆∞u
                    </button>
                </div>
                <div class="modal-loading" id="locationModalLoading">
                    <div class="modal-spinner"></div>
                    <span>‰øùÂ≠ò‰∏≠... - ƒêang l∆∞u...</span>
                </div>
            </div>
        </div>

        <!-- Shipment Modal - FIXED LAYOUT -->
        <div id="shipmentModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üöö Âá∫Ëç∑Ë®òÈå≤ - V·∫≠n chuy·ªÉn</h3>
                    <button onclick="closeModal('shipmentModal')" class="modal-close">√ó</button>
                </div>
                <div class="modal-body">
                    <!-- Current Status Info -->
                    <div class="current-info">
                        <div class="current-info-title">ÁèæÂú®Áä∂ÊÖã - Tr·∫°ng th√°i hi·ªán t·∫°i</div>
                        <div class="current-info-value" id="currentStatusDisplay">-</div>
                    </div>
                    
                    <form id="shipmentForm" class="compact-form">
                        <div class="form-group">
                            <label>ÈÄÅ„ÇäÂÖà‰ºöÁ§æ - C√¥ng ty nh·∫≠n <span class="required">*</span></label>
                            <select id="toCompanySelect" onchange="handleCompanySelect()" required>
                                <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ - Ch·ªçn c√¥ng ty</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="customCompanyGroup" style="display: none;">
                            <label>‰ºöÁ§æÂêç - T√™n c√¥ng ty <span class="required">*</span></label>
                            <input type="text" id="customCompanyName" placeholder="‰ºöÁ§æÂêç„ÇíÂÖ•Âäõ - Nh·∫≠p t√™n c√¥ng ty">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>ÊãÖÂΩìËÄÖ - Ng∆∞·ªùi ph·ª• tr√°ch <span class="required">*</span></label>
                                <input type="text" id="contactPerson" placeholder="ÊãÖÂΩìËÄÖÂêç" required>
                            </div>
                            <div class="form-group">
                                <label>Âá∫Ëç∑Êó• - Ng√†y g·ª≠i <span class="required">*</span></label>
                                <input type="date" id="shipDate" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>ÂÇôËÄÉ - Ghi ch√∫</label>
                            <textarea id="shipNotes" placeholder="Âá∫Ëç∑„Å´Èñ¢„Åô„ÇãË©≥Á¥∞ÊÉÖÂ†± - Chi ti·∫øt v·∫≠n chuy·ªÉn..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" onclick="closeModal('shipmentModal')" class="btn-secondary">
                        „Ç≠„É£„É≥„Çª„É´ - H·ªßy
                    </button>
                    <button type="submit" form="shipmentForm" class="btn-primary">
                        üíæ ‰øùÂ≠ò - L∆∞u
                    </button>
                </div>
                <div class="modal-loading" id="shipmentModalLoading">
                    <div class="modal-spinner"></div>
                    <span>‰øùÂ≠ò‰∏≠... - ƒêang l∆∞u...</span>
                </div>
            </div>
        </div>

        <!-- Feedback Modal - FIXED LAYOUT -->
        <div id="feedbackModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üí¨ „Ç≥„É°„É≥„ÉàËøΩÂä† - Th√™m ghi ch√∫</h3>
                    <button onclick="closeModal('feedbackModal')" class="modal-close">√ó</button>
                </div>
                <div class="modal-body">
                    <form id="feedbackForm" class="compact-form">
                        <div class="form-group">
                            <label>„Ç≥„É°„É≥„Éà - Ghi ch√∫ <span class="required">*</span></label>
                            <textarea id="feedbackText" required placeholder="‰æãÔºö‰øÆÁêÜ„ÅåÂøÖË¶Å„ÄÅÈÉ®ÂìÅ‰∫§Êèõ„Å™„Å© - V√≠ d·ª•: C·∫ßn s·ª≠a ch·ªØa, thay linh ki·ªán..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Ë®òÈå≤ËÄÖ - Ng∆∞·ªùi ghi <span class="required">*</span></label>
                            <select id="feedbackEmployeeSelect" required>
                                <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ - Ch·ªçn nh√¢n vi√™n</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" onclick="closeModal('feedbackModal')" class="btn-secondary">
                        „Ç≠„É£„É≥„Çª„É´ - H·ªßy
                    </button>
                    <button type="submit" form="feedbackForm" class="btn-primary">
                        üíæ ‰øùÂ≠ò - L∆∞u
                    </button>
                </div>
                <div class="modal-loading" id="feedbackModalLoading">
                    <div class="modal-spinner"></div>
                    <span>‰øùÂ≠ò‰∏≠... - ƒêang l∆∞u...</span>
                </div>
            </div>
        </div>

        <!-- Loading -->
        <div id="loadingDetail" class="loading">
            <div class="spinner"></div>
            <span class="loading-text">Ë™≠„ÅøËæº„Åø‰∏≠... - ƒêang t·∫£i...</span>
        </div>
    </div>

    <script src="js/detail.js"></script>
</body>
</html>
